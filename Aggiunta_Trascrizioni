## READ FINAL TRANSCRIPTS DATASET
transcripts_dataset_path = "s3://tedx-2025-data-ys-20250315/final_with_transcripts_10.csv"

transcripts_dataset = spark.read \
    .option("header", "true") \
    .option("quote", "\"") \
    .option("escape", "\"") \
    .csv(transcripts_dataset_path)

transcripts_dataset = transcripts_dataset.select(
    col("id").alias("id_ref"),
    col("transcript")
)

# JOIN TRANSCRIPTS WITH MAIN DATASET
tedx_dataset_final = tedx_dataset_final.join(transcripts_dataset, tedx_dataset_final._id == transcripts_dataset.id_ref, "left") \
    .drop("id_ref")
